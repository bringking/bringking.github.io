<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: WP7 | Coding in the basement]]></title>
  <link href="http://charlesbking.com/blog/categories/wp7/atom.xml" rel="self"/>
  <link href="http://charlesbking.com/"/>
  <updated>2014-03-09T21:51:52-07:00</updated>
  <id>http://charlesbking.com/</id>
  <author>
    <name><![CDATA[Charles King]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Paginated View on WP7]]></title>
    <link href="http://charlesbking.com/blog/2012/07/23/paginated-view-on-wp7/"/>
    <updated>2012-07-23T07:41:00-07:00</updated>
    <id>http://charlesbking.com/blog/2012/07/23/paginated-view-on-wp7</id>
    <content type="html"><![CDATA[<p>What I wanted to detail in these upcoming posts was how I implemented a paginated view for the &ldquo;card deck&rdquo; on each platform. To sum it up, Android and iOS
provided better better controls out of the box to implement this functionality. Windows Phone 7 was kind of a pain so we will start with that first. So what was the end goal? The
end goal was a fluid image-gallery type experience that allowed users to swipe through the cards with touch rather than buttons. This
type of functionality is extremely common on mobile apps so I imagined there would be built in controls in the frameworks. Well I was half right..</p>

<!-- more -->


<h2>WP7 Pivot</h2>

<p>Windows Phone 7 has no obvious choice for this control, however with some template modification, I ended up using the <a href="http://msdn.microsoft.com/en-us/library/microsoft.phone.controls.pivot(v=vs.92.aspx">Pivot</a>.
The pivot control is a common element in metro style apps. The great thing about the pivot control is it inherits from ItemsControl,
which gave me all the properties and events that I need to get the functionality, most importantly the SelectedItem property and LoadedPivotItem and UnloadedPivotItem events.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="ni">&amp;lt;</span>phone:PhoneApplicationPage.Resources&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>Style x:Key=&quot;PivotItemStyle1&quot; TargetType=&quot;controls:PivotItem&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>Setter Property=&quot;Template&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>ControlTemplate TargetType=&quot;controls:PivotItem&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>                <span class="ni">&amp;lt;</span>Grid<span class="ni">&amp;gt;</span>
</span><span class='line'>                    <span class="ni">&amp;lt;</span>Grid.RowDefinitions<span class="ni">&amp;gt;</span>
</span><span class='line'>                        <span class="ni">&amp;lt;</span>RowDefinition Height=&quot;Auto&quot;/<span class="ni">&amp;gt;</span>
</span><span class='line'>                        <span class="ni">&amp;lt;</span>RowDefinition Height=&quot;*&quot;/<span class="ni">&amp;gt;</span>
</span><span class='line'>                    <span class="ni">&amp;lt;</span>Grid.RowDefinitions/<span class="ni">&amp;gt;</span>
</span><span class='line'>                <span class="ni">&amp;lt;</span>Image Source=&quot;{Binding ImageUri}&quot; Stretch=&quot;Uniform&quot; Height=&quot;630&quot; Grid.Row=&quot;0&quot;/<span class="ni">&amp;gt;</span>
</span><span class='line'>                <span class="ni">&amp;lt;</span>TextBlock Text={&quot;Binding Name}&quot; FontFamily=&quot;Segoe WP Semibold&quot; Grid.Row=&quot;1&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>                <span class="ni">&amp;lt;</span>/Grid<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>/ControlTemplate<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>/Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>/Setter<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>/Style<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span><span class="ni">&amp;lt;</span>/phone:PhoneApplicationPage.Resources&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span><span class="ni">&amp;lt;</span>controls:Pivot ItemsSource={<span class="ni">&amp;ldquo;</span>Binding CardList<span class="ni">&amp;rdquo;</span>} LoadedPivotItem=<span class="ni">&amp;ldquo;</span>MainPivotLoadedPivotItem<span class="ni">&amp;rdquo;</span> UnloadedPivotItem=<span class="ni">&amp;ldquo;</span>MainPivotUnloadedPivotItem<span class="ni">&amp;rdquo;</span>  ItemContainerStyle={<span class="ni">&amp;ldquo;</span>StaticResource PivotItemStyle1}<span class="ni">&amp;rdquo;</span>/&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So the layout code is fairly simple, a pivot control whose ItemsSource is databound to your viewmodel, and implements a custom style to get the layout the way you want it and binds the items to the viewmodel.
So in your code you can subscribe to the LoadedPivotItem and UnloadedPivotItem events to access your Items every time the user changes the cards</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="nf">CardPage</span><span class="p">()</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">//apply datacontext to the page to bind to my viewmodel.</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="n">DataContext</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">ViewModel</span><span class="p">;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">MainPivotLoadedItem</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PivotItemEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">//get reference to control</span>
</span><span class='line'><span class="kt">var</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">sender</span> <span class="k">as</span> <span class="n">Pivot</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">pivot</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//get reference to SelectedItem as cast as my bound object</span>
</span><span class='line'><span class="kt">var</span> <span class="n">card</span> <span class="p">=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">SelectedItem</span> <span class="k">as</span> <span class="n">CardModel</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//do some stuff if required. In my case, play a sound effect and narration file</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">card</span> <span class="p">!=</span><span class="k">null</span><span class="p">)</span> <span class="n">card</span><span class="p">.</span><span class="n">PlaySound</span><span class="p">();</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">MainPivotUnLoadedItem</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PivotItemEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">//get reference to control</span>
</span><span class='line'><span class="kt">var</span> <span class="n">pivot</span> <span class="p">=</span> <span class="n">sender</span> <span class="k">as</span> <span class="n">Pivot</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">pivot</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//get reference to SelectedItem as cast as my bound object</span>
</span><span class='line'><span class="kt">var</span> <span class="n">card</span> <span class="p">=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">SelectedItem</span> <span class="k">as</span> <span class="n">CardModel</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//do some stuff if required. In my case, stop any playing sound as card is was unloaded</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">card</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="n">card</span><span class="p">.</span><span class="n">KillSounds</span><span class="p">();</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>Pivot problems</h3>

<p>In the end this solution is nice for its simplicity. First, the pivot control doesn&rsquo;t provide the experience you would expect from
this type of application. Each item that is not in view is hidden, so without a header each item just kind of appears and animates into view. Secondly, the first problem
is exaggerated since the Pivot control does not support dragging, which I found out is highly annoying to some users. See the video below for an example of
what I am talking about.</p>

<p><iframe width="100%" height="390" src="http://www.youtube.com/embed/nFPv0JQqKkk " frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>

<h3>Panorama</h3>

<p>So after some a few hours of racking my brain trying to create my own control by sub-classing ListBox, or adding to ScrollViewer with a
StackPanel, I realized that another Microsoft.Phone.Controls class did exactly what I needed; the Panorama. Again, the Panorama required some templating
to get the look layout I was after.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span><span class="ni">&amp;lt;</span>phone:PhoneApplicationPage.Resources&gt;
</span><span class='line'>   <span class="nt">&lt;Style</span> <span class="na">x:Key=</span><span class="s">&quot;PanoramaStyle1&quot;</span> <span class="na">TargetType=</span><span class="s">&quot;controls:Panorama&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span>    <span class="ni">&amp;lt;</span>Setter Property=&quot;ItemsPanel&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>ItemsPanelTemplate<span class="ni">&amp;gt;</span>
</span><span class='line'>          <span class="ni">&amp;lt;</span>controlsPrimitives:PanoramaPanel x:Name=&quot;panel&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="ni">&amp;lt;</span>/ItemsPanelTemplate<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>/Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>/Setter<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>Setter Property=&quot;Foreground&quot; Value=&quot;{StaticResource PhoneForegroundBrush}&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>Setter Property=&quot;Background&quot; Value=&quot;Transparent&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>Setter Property=&quot;Template&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>ControlTemplate TargetType=&quot;controls:Panorama&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>          <span class="ni">&amp;lt;</span>Grid<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>Grid.RowDefinitions<span class="ni">&amp;gt;</span>
</span><span class='line'>              <span class="ni">&amp;lt;</span>RowDefinition Height=&quot;1&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>              <span class="ni">&amp;lt;</span>RowDefinition Height=&quot;*&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>/Grid.RowDefinitions<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>controlsPrimitives:PanningBackgroundLayer x:Name=&quot;BackgroundLayer&quot;
</span><span class='line'>                                                       HorizontalAlignment=&quot;Left&quot; Grid.RowSpan=&quot;2&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>              <span class="ni">&amp;lt;</span>Border x:Name=&quot;background&quot; Background=&quot;{TemplateBinding Background}&quot;
</span><span class='line'>                      CacheMode=&quot;BitmapCache&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>/controlsPrimitives:PanningBackgroundLayer<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>controlsPrimitives:PanningTitleLayer x:Name=&quot;TitleLayer&quot; CacheMode=&quot;BitmapCache&quot;
</span><span class='line'>                                                  ContentTemplate=&quot;{TemplateBinding TitleTemplate}&quot; Content=&quot;{TemplateBinding Title}&quot; FontSize=&quot;187&quot;
</span><span class='line'>                                                  FontFamily=&quot;{StaticResource PhoneFontFamilyLight}&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;0,0,0,0&quot; Grid.Row=&quot;0&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>
</span><span class='line'>            <span class="ni">&amp;lt;</span>controlsPrimitives:PanningLayer x:Name=&quot;ItemsLayer&quot; HorizontalAlignment=&quot;Left&quot;
</span><span class='line'>                                             Grid.Row=&quot;1&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>
</span><span class='line'>              <span class="ni">&amp;lt;</span>ItemsPresenter x:Name=&quot;items&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>            <span class="ni">&amp;lt;</span>/controlsPrimitives:PanningLayer<span class="ni">&amp;gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>          <span class="ni">&amp;lt;</span>/Grid<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>/ControlTemplate<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>/Setter.Value<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>/Setter<span class="ni">&amp;gt;</span>
</span><span class='line'>  <span class="ni">&amp;lt;</span>/Style<span class="ni">&amp;gt;</span>
</span><span class='line'>  <span class="ni">&amp;lt;</span>DataTemplate x:Key=&quot;loadedItemsTemplate&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>StackPanel Margin=&quot;0,-30,0,0&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>Image Width=&quot;800&quot; Height=&quot;340&quot; Source=&quot;{Binding ImageSource}&quot; Stretch=&quot;Uniform&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>StackPanel HorizontalAlignment=&quot;Center&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>TextBlock TextWrapping=&quot;Wrap&quot; Text=&quot;{Binding Name}&quot; Foreground=&quot;#FF726A6A&quot;
</span><span class='line'>                   FontFamily=&quot;../Fonts/Albertsthal_Typewriter.ttf#Albertsthal Typewriter&quot; FontSize=&quot;35&quot; FontWeight=&quot;Bold&quot;
</span><span class='line'>                   d:LayoutOverrides=&quot;Width&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>TextBlock TextWrapping=&quot;Wrap&quot; Text=&quot;{Binding Phoenetic}&quot; Foreground=&quot;#FF726A6A&quot;
</span><span class='line'>                   FontFamily=&quot;Courier New&quot; FontStyle=&quot;Italic&quot; FontSize=&quot;18.667&quot; FontWeight=&quot;Bold&quot; d:LayoutOverrides=&quot;Width&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>/StackPanel<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>/StackPanel<span class="ni">&amp;gt;</span>
</span><span class='line'>  <span class="ni">&amp;lt;</span>/DataTemplate<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span> <span class="ni">&amp;lt;</span>/phone:PhoneApplicationPage.Resources&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span> <span class="nt">&lt;Grid</span> <span class="na">x:Name=</span><span class="s">&quot;LayoutRoot&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>controls:Panorama x:Name=&quot;MainPanorama&quot; ItemsSource=&quot;{Binding Dinosaurs}&quot; ItemTemplate=&quot;{StaticResource loadItemsTemplate}&quot; Style=&quot;{PanoramaStyle1}&quot;/<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>  <span class="nt">&lt;/Grid&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So with this template, I changed the style of the panorama to minimize the massive header section to make it look more like a card. For the panorama,
everything is loaded at runtime, so there are no LoadedItem or UnloadedItem events to subscribe to. This makes getting the currently selected item
a little different than the Pivot control. The relevant event to handle for the Panorama is the SelectionChanged event. You can utilize it in your
code-behind, or preferably your <a href="http://www.codeproject.com/Articles/160892/Binding-Events-to-Methods-in-the-Silverlight-MVVM">viewmodel</a>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">public</span> <span class="n">MainPage</span><span class="p">()</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="c1">//apply datacontext to the page to bind to my viewmodel.</span>
</span><span class='line'><span class="k">this</span><span class="p">.</span><span class="n">DataContext</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">ViewModel</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//subscribe to the selection changed event</span>
</span><span class='line'><span class="n">MainPanorama</span><span class="p">.</span><span class="n">SelectionChanged</span> <span class="p">+=</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="p">(</span><span class="n">ListSelectionChanged</span><span class="p">);</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span><span class="k">private</span> <span class="k">void</span> <span class="n">ListSelectionChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SelectionChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span><span class="n">Card</span> <span class="n">newItem</span><span class="p">;</span>
</span><span class='line'><span class="n">Card</span> <span class="n">oldItem</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//get the currently selected panorama item </span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">AddedItems</span><span class="p">.</span><span class="n">Count</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>     <span class="n">currentItem</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">AddedItems</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="k">as</span> <span class="n">Card</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//get previous item that was unselected </span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RemovedItems</span><span class="p">.</span><span class="n">Count</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>     <span class="n">oldItem</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">RemovedItems</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="k">as</span> <span class="n">Card</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//do some on change some stuff. In my case, play some sounds.</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">oldItem</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="n">oldItem</span><span class="p">.</span><span class="n">KillSounds</span><span class="p">();</span>
</span><span class='line'><span class="k">if</span><span class="p">(</span><span class="n">newItem</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="n">newItem</span><span class="p">.</span><span class="n">PlaySounds</span><span class="p">();</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;}&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So anyways that is pretty straightforward and is a much nicer experience for the user. I have seen many blog posts detailing the use of the Pivot control for
an items reel of sorts. IMHO, the panorama is nicer. See the difference in the video below&hellip;</p>

<p><iframe width="100%" height="390" src="http://www.youtube.com/embed/TE_z7BUQrYQ " frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>

<h3>Lazy loading</h3>

<p>So the downside to the panorama control is that it utilizes a non-virtualized panel for its ItemsControl.  What does this mean for us? It means that every Image in the view
is going to load and display on startup. That absolutely kills your memory. Microsoft recommends that you keep your peak memory usage below 90MB, I could easily surpass that with
around 30 images loading in the panorama without lazy-loading. So to get acceptable performance I <em>had</em> to implement some lazy-loading technique for the images in bound collection.
To implement this, I started with my datamodel.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;[</span><span class="n">DataContractAttribute</span><span class="p">]</span>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">Card</span> <span class="p">:</span> <span class="n">INotifyPropertyChanged</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="c1">//this is the relative path to the card image. </span>
</span><span class='line'><span class="na">        [DataMember]</span>
</span><span class='line'>        <span class="k">public</span> <span class="kt">string</span> <span class="n">ImageUri</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span><span class='line'>
</span><span class='line'><span class="na">        [DataMember]</span>
</span><span class='line'>        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span><span class='line'>
</span><span class='line'><span class="na">        [DataMember]</span>
</span><span class='line'>        <span class="k">public</span> <span class="kt">string</span> <span class="n">Phoenetic</span> <span class="p">{</span><span class="k">get</span><span class="p">;</span><span class="k">set</span><span class="p">;}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//this is the ImageSource class that I will bind to in my view.</span>
</span><span class='line'>        <span class="k">private</span> <span class="n">ImageSource</span> <span class="n">_imgSource</span><span class="p">;</span>
</span><span class='line'><span class="na">        [IgnoreDataMember]</span>
</span><span class='line'>        <span class="k">public</span> <span class="n">ImageSource</span> <span class="n">ImageSource</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">get</span><span class="p">{</span><span class="k">return</span> <span class="n">_imgSource</span><span class="p">;}</span>
</span><span class='line'>            <span class="k">set</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                <span class="k">if</span><span class="p">(</span><span class="n">_imgSource</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="p">!</span><span class="n">_imgSource</span><span class="p">.</span><span class="n">Equals</span><span class="p">(</span><span class="k">value</span><span class="p">))</span>
</span><span class='line'>                <span class="p">{</span>
</span><span class='line'>                    <span class="n">_imgSource</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span><span class='line'>                    <span class="n">OnPropertyChanged</span><span class="p">(</span><span class="s">&quot;ImageSource&quot;</span><span class="p">);</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">public</span> <span class="k">event</span> <span class="n">PropertChangedEventHandler</span> <span class="n">PropertyChanged</span><span class="p">;</span>
</span><span class='line'>        <span class="k">protected</span> <span class="k">void</span> <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span><span class="p">(</span><span class="n">PropertyChanged</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>                <span class="n">PropertyChanged</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">new</span> <span class="n">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">propertyName</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So now I have this nice data model that holds both the ImageURI and an ImageSource property that I can bind to. Let&rsquo;s look at the data template for the Panorama one more time-</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span> <span class="nt">&lt;DataTemplate</span> <span class="na">x:Key=</span><span class="s">&quot;loadedItemsTemplate&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span>    <span class="ni">&amp;lt;</span>StackPanel Margin=&quot;0,-30,0,0&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>Image Width=&quot;800&quot; Height=&quot;340&quot; Source=&quot;{Binding ImageSource}&quot; Stretch=&quot;Uniform&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>StackPanel HorizontalAlignment=&quot;Center&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>TextBlock TextWrapping=&quot;Wrap&quot; Text=&quot;{Binding Name}&quot; Foreground=&quot;#FF726A6A&quot;
</span><span class='line'>                   FontFamily=&quot;../Fonts/Albertsthal_Typewriter.ttf#Albertsthal Typewriter&quot; FontSize=&quot;35&quot; FontWeight=&quot;Bold&quot;
</span><span class='line'>                   d:LayoutOverrides=&quot;Width&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>        <span class="ni">&amp;lt;</span>TextBlock TextWrapping=&quot;Wrap&quot; Text=&quot;{Binding Phoenetic}&quot; Foreground=&quot;#FF726A6A&quot;
</span><span class='line'>                   FontFamily=&quot;Courier New&quot; FontStyle=&quot;Italic&quot; FontSize=&quot;18.667&quot; FontWeight=&quot;Bold&quot; d:LayoutOverrides=&quot;Width&quot; /<span class="ni">&amp;gt;</span>
</span><span class='line'>      <span class="ni">&amp;lt;</span>/StackPanel<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>/StackPanel<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span> <span class="nt">&lt;/DataTemplate&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now here lets take a look at my Viewmodel. If you remember from earlier, the important event handler for the Panorama control for my use was the SelectionChanged event.
On the SelectionChanged event, I get the index of the currently selected item, and essentially start a background worker to assign the ImageSource
property from the ImageUri property for the next two images. At the same time, I null the references to ImageSource for the previous two images. This allows the GC to free up their memory on the
next cycle.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>[ ] </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="p">&lt;/</span><span class="n">p</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">pre</span><span class="p">&gt;&lt;</span><span class="n">code</span><span class="p">&gt;</span> <span class="k">public</span> <span class="k">void</span> <span class="n">ListSelectionChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SelectionChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// get current selected card</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">currentItem</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">AddedItems</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="k">as</span> <span class="n">Card</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// add two more card in worker thread </span>
</span><span class='line'>        <span class="n">LoadImageViewCardsAsync</span><span class="p">(</span><span class="n">currentItem</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">/// &amp;lt;summary&amp;gt;</span>
</span><span class='line'>    <span class="c1">/// Loads the next two card images in the deck and unloads the previous two</span>
</span><span class='line'>    <span class="c1">/// &amp;lt;/summary&amp;gt;</span>
</span><span class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">LoadImageViewCardsAsync</span><span class="p">(</span><span class="n">Card</span> <span class="n">currentCard</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">bgWorker</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BackgroundWorker</span><span class="p">();</span>
</span><span class='line'>        <span class="n">bgWorker</span><span class="p">.</span><span class="n">DoWork</span> <span class="p">+=</span> <span class="n">BgWorkerDoWork</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="kt">var</span> <span class="n">index</span> <span class="p">=</span> <span class="n">Dinosaurs</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">(</span><span class="n">currentCard</span><span class="p">);</span>
</span><span class='line'>        <span class="n">bgWorker</span><span class="p">.</span><span class="n">RunWorkerAsync</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">private</span> <span class="k">void</span> <span class="nf">BgWorkerDoWork</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DoWorkEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="kt">var</span> <span class="n">index</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">e</span><span class="p">.</span><span class="n">Argument</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="n">index</span><span class="p">;</span> <span class="n">i</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="p">(</span><span class="n">index</span> <span class="p">+</span> <span class="m">2</span><span class="p">);</span> <span class="n">i</span><span class="p">++)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">Dinosaurs</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">i1</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>            <span class="n">_dispatcher</span><span class="p">.</span><span class="n">BeginInvoke</span><span class="p">(</span><span class="k">delegate</span>
</span><span class='line'>                                        <span class="p">{</span>
</span><span class='line'>                                            <span class="kt">var</span> <span class="n">bmp</span> <span class="p">=</span>
</span><span class='line'>                                                <span class="k">new</span> <span class="nf">BitmapImage</span><span class="p">(</span><span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="n">Dinosaurs</span><span class="p">[</span><span class="n">i1</span><span class="p">].</span><span class="n">ImageUri</span><span class="p">,</span> <span class="n">UriKind</span><span class="p">.</span><span class="n">Relative</span><span class="p">));</span>
</span><span class='line'>                                            <span class="n">Dinosaurs</span><span class="p">[</span><span class="n">i1</span><span class="p">].</span><span class="n">ImageSource</span> <span class="p">=</span> <span class="n">bmp</span><span class="p">;</span>
</span><span class='line'>                                        <span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">//remove old images from UI by nulling the reference</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="n">index</span> <span class="p">-</span> <span class="m">2</span><span class="p">;</span> <span class="n">i</span> <span class="p">&amp;</span><span class="n">gt</span><span class="p">;=</span> <span class="p">(</span><span class="n">index</span> <span class="p">-</span> <span class="m">3</span><span class="p">);</span> <span class="n">i</span><span class="p">--)</span>
</span><span class='line'>        <span class="p">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="m">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>            <span class="kt">var</span> <span class="n">i1</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
</span><span class='line'>            <span class="n">_dispatcher</span><span class="p">.</span><span class="n">BeginInvoke</span><span class="p">(</span><span class="k">delegate</span> <span class="p">{</span> <span class="n">Dinosaurs</span><span class="p">[</span><span class="n">i1</span><span class="p">].</span><span class="n">ImageSource</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span> <span class="p">});</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">code</span><span class="p">&gt;&lt;/</span><span class="n">pre</span><span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;</span><span class="n">p</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So what was the result of this? For about 57 cards being loaded at a time, I was able to reduce my memory usage from 100MB to ~50MB while
viewing a flash card deck. If you run the Memory Analyzer you will see that it is the image loads on the UI that kill the memory, so this method
removes that barrier. To go even further, you could implement a buffer collection that is bound to the Panorama and dynamically load and unload full
items, however without the image my objects are very small so that was overkill for me.</p>

<h3>Drawbacks</h3>

<p> The main drawback with using a panorama control is the initial load time for a page utilizing a panorama. Check out this telerik <a href="http://blogs.telerik.com/blogs/posts/10-11-01/windows-phone-7-performance---emulator-vs-physical-device.aspx">post</a> about
 the subject. This drawback was acceptable for me for the vastly better user experience vs. a pivot control.</p>

<h3>FlipView to the rescue</h3>

<p> I wanted to add this in- Windows 8 fixes this problem and introduces a control called <a href="http://msdn.microsoft.com/en-us/library/windows/apps/hh850405.aspx">FlipView</a>. Awesome control that can be virtualized and databound with built-in touch and button navigation.</p>

<p> Next post I will talk about my Android implementation!</p>
]]></content>
  </entry>
  
</feed>
